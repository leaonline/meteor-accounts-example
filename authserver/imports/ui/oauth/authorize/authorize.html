<template name="authorize">
	{{#unless loadComplete}}
		Loading, please wait...
	{{else}}
		{{#with errors}}
			<h1>Invalid request</h1>
			{{#each error in this}}
				<div class="alert-danger alert">
					<strong>{{stringify error}}</strong>
				</div>
			{{/each}}
		{{else}}
			{{#if currentUser}}
				<h1>Confirm request for following resources:</h1>

				<ul>
					{{#each resource in requestedResources}}
						<li>{{resource}}</li>
					{{/each}}
				</ul>

				<form id="authform" method="POST" action="{{redirectUrl}}?code={{code}}&state={{state}}" role="form">
				<input type="hidden" name="state" value="{{state}}">
				<input type="hidden" name="code" value="{{code}}">
				<button class="btn btn-primary btn-block" type="submit">Authorise</button>
				</form>
				<div class="text-center p-2">or</div>
				<form id="authform" method="POST" action="{{redirectUrl}}" role="form">
					<button class="btn btn-outline-secondary btn-block" type="submit">Deny</button>
				</form>
			{{else}}
				{{> login}}
			{{/if}}
		{{/with}}
	{{/unless}}
</template>